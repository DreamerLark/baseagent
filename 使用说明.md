# BaseAgent CLI 快速指南

## 概述

我已经创建了一个完整的BaseAgent CLI工具，支持技能（Skills）和MCP（Model Context Protocol）功能。

## 文件清单

### 核心文件
- **`cli.py`** - 主CLI工具，使用Click框架
- **`mcp-config-example.json`** - 详细配置示例（带注释）
- **`mcp-config-simple.json`** - 简单配置示例
- **`time_service.py`** - MCP服务器示例

### 文档文件
- **`CLI_README.md`** - 完整使用文档
- **`使用说明.md`** - 本文件

### 测试和演示文件
- **`test_cli.py`** - 功能测试脚本
- **`demo_server.py`** - 简单MCP服务器示例
- **`quick_start.py`** - 快速开始演示

## 快速开始

### 1. 环境设置

```bash
# 创建虚拟环境
python3 -m venv venv
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

### 2. 基本命令

```bash
# 查看帮助
python cli.py --help

# 查看使用示例
python cli.py examples

# 查看agent状态
python cli.py info

# 列出技能
python cli.py list-skills

# 生成配置示例
python cli.py generate-config --output my-config.json

# 加载MCP配置
python cli.py load-mcp-config sample-mcp-config.json

# 查看MCP服务器
python cli.py list-mcp
```

### 3. 交互式对话

```bash
# 设置API密钥（需要）
export OPENAI_API_KEY="your-openai-api-key"

# 开始对话
python cli.py chat
```

## 主要功能

### 技能管理
- 列出所有技能
- 从文件添加新技能
- 支持Anthropic Skills格式

### MCP服务器管理
- 从JSON/JSONC文件加载配置
- 手动添加MCP服务器
- 查看服务器状态和工具列表

### 配置格式
支持标准JSON和JSONC格式：

```json
{
  "mcpServers": {
    "server-name": {
      "command": ["python", "server.py"],
      "timeout": 30,
      "env": {
        "KEY": "value"
      }
    }
  }
}
```

## 示例工作流

### 完整设置流程

```bash
# 1. 查看示例
python cli.py examples

# 2. 生成配置文件
python cli.py generate-config --output my-mcp-config.json

# 3. 编辑配置文件（添加你的API密钥等）
# vim my-mcp-config.json

# 4. 加载配置
python cli.py load-mcp-config my-mcp-config.json

# 5. 验证设置
python cli.py info

# 6. 开始对话
python cli.py chat
```

### 添加自定义技能

```bash
# 创建技能指令文件
cat > my_skill.md << 'EOF'
# 我的技能

你是一个专业的助手，能够...

## 能力
- 能力1
- 能力2

## 使用指南
- 指南1
- 指南2
EOF

# 添加技能
python cli.py add-skill "my-skill" "描述" my_skill.md --tags tag1 tag2

# 查看技能
python cli.py list-skills
```

### 添加自定义MCP服务器

```bash
# 方法1: 手动添加
python cli.py add-mcp-server my-server python my_server.py --env TZ=Asia/Shanghai

# 方法2: 从配置文件加载
# 编辑JSON配置文件，然后加载
python cli.py load-mcp-config my-config.json
```

## 技术特点

### 1. 基于Anthropic Skills
- 使用YAML frontmatter + Markdown指令格式
- 支持版本、标签、示例等元数据
- AI指导性而非工具性技能

### 2. MCP集成
- 支持JSON-RPC 2.0 over stdio
- 兼容官方MCP规范
- 支持环境变量配置

### 3. CLI设计
- 使用Click框架，命令友好
- 支持环境变量配置
- 提供详细的帮助信息

## 配置示例

### 基础MCP配置 (mcp-config-simple.json)
```json
{
  "mcpServers": {
    "filesystem": {
      "command": ["npx", "-y", "@modelcontextprotocol/server-filesystem", "/tmp"],
      "env": {
        "TZ": "Asia/Shanghai"
      }
    },
    "time_service": {
      "command": ["python", "time_service.py"],
      "env": {
        "TZ": "Asia/Shanghai"
      }
    }
  }
}
```

### 完整MCP配置 (mcp-config-example.json)
```json
{
  "mcpServers": {
    "filesystem": {
      "command": ["npx", "-y", "@modelcontextprotocol/server-filesystem", "/tmp"],
      "env": {
        "TZ": "Asia/Shanghai"
      },
      "description": "文件系统操作工具"
    },
    "weather": {
      "command": ["python", "./weather_service.py"],
      "timeout": 60,
      "env": {
        "API_KEY": "your-weather-api-key-here",
        "TZ": "Asia/Shanghai"
      },
      "description": "天气查询服务"
    }
  }
}
```

## 故障排除

### 常见问题

1. **ModuleNotFoundError: No module named 'click'**
   ```bash
   pip install click
   ```

2. **OpenAI API key未配置**
   ```bash
   export OPENAI_API_KEY="your-api-key"
   ```

3. **MCP服务器启动失败**
   - 检查命令路径是否正确
   - 确保有执行权限
   - 查看依赖是否安装

### 调试方法

```bash
# 查看详细错误
python cli.py list-mcp

# 检查配置文件语法
python -m json.tool your-config.json

# 测试MCP服务器
python your_mcp_server.py
```

## 演示和测试

```bash
# 运行功能测试
python test_cli.py

# 快速开始演示
python quick_start.py

# 查看完整文档
cat CLI_README.md
```

## 总结

这个CLI工具提供了BaseAgent的完整命令行接口：

✅ **交互式对话** - 与agent实时对话
✅ **技能管理** - 注册和管理Anthropic Skills
✅ **MCP服务器** - 从配置文件加载MCP服务器
✅ **配置生成** - 自动生成示例配置
✅ **状态监控** - 查看agent状态和工具列表

立即开始：运行 `python cli.py examples` 查看所有可用命令！